<!DOCTYPE html>
<html>
<head>
	<title>Vaccination Alert</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
</head>
<body>
	<div class="container">
		<div class="row">
			<h1>Get Vaccine alert</h1>
		</div>
		<form name="userInfo" id="userInfo">
			<div class="row">
				<div class="col-6 form-group">
					<label>Name :</label><br>
					<input type="text"  class="form-control" placeholder="Enter Name" name="name" required="">
				</div>
				<div class="col-6 form-group">
					<label>Email :</label><br>
					<input type="text"  class="form-control" placeholder="Enter Email" name="email" required="">
				</div>
			</div>
			<div class="row">
				<div class="col-6 form-group">
					<label for="#state">State :</label><br>
					<select name="state" class="form-control" id="state" required="">
						<option> Select State</option>
					</select>
				</div>
				<div class="col-6 form-group">
					<label for="#district">District :</label><br>
					<select name="district" class="form-control" id="district" required="">
						<option value="0"> Select District</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-6 form-group">
					<label>You are :</label><br>
					<select name="age" class="form-control" required="">
						<option value="18"> 18+</option>
						<option value="45"> 45+</option>
					</select>
				</div>
			</div>
			<div class="row">
				<button type="submit" class="btn btn-primary col-12">Save</button>
			</div>
		</div>
		<div class="row">
			<div class="col-3"></div>
			<div class="col-6" id="info"></div>
			<div class="col-3"></div>
		</div>
	</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src=" https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script type="text/javascript">

	$(document).ready(function(){
		$.ajax({
			url : 'https://cdn-api.co-vin.in/api/v2/admin/location/states/',
			type : 'GET',
			dataType:'JSON',
			success:function(data) {
				data.states.forEach(x=>{
					$("#state").append('<option value="'+x.state_id+'">'+x.state_name+'</option>')	
				})
				
				console.log('state',data)
			}
		})

		$("#state").change(function(){
			$("#district").html("<option value=0> Select District</option>")
			$.ajax({
				url : 'https://cdn-api.co-vin.in/api/v2/admin/location/districts/'+$(this).val(),
				type : 'GET',
				dataType:'JSON',
				success:function(data) {
					console.log('districts',data)
					data.districts.forEach(x=>{
						$("#district").append('<option value="'+x.district_id+'">'+x.district_name+'</option>')	
					})
				}
			})	
		})

		$("#userInfo").submit(function(){
			if($("#district").val()>0){
				$.ajax({
					url : 'http://localhost/elitmail/saveUser.php',
					type : 'Post',
					data : $("#userInfo").serialize(),
					success:function(data) {
			            Swal.fire({
			                position: 'center',
			                icon: 'success',
			                title: 'Your information is saved',
			                showConfirmButton: false,
			                timer: 1500
			            })
		                // window.setTimeout(function(){location.reload(); } ,2000);   
					}
				})
			}
			else{
	            Swal.fire({
	                position: 'center',
	                icon: 'warning',
	                title: 'Please enter all details',
	                showConfirmButton: false,
	                timer: 1500
	            })
			}
			return false;
		})
	})

</script>
</body>
</html>